<div class="container my-4">
  <div class="card border-0 shadow-sm rounded-3 overflow-hidden">
    <div class="card-header bg-gradient-primary text-white py-3 px-4">
      <div class="d-flex justify-content-between align-items-center">
        <h2 class="h5 mb-0 fw-light">
          <i class="bi bi-chat-square-text-fill me-2"></i>
          Feedback Analysis - {{ selectedEventTitle || 'Selected Event' }}
        </h2>
        <span class="badge bg-white text-primary rounded-pill">{{feedbacks.length}} responses</span>
      </div>
    </div>

    <div class="card-body p-0">
      <!-- Loading State -->
      <div *ngIf="isLoading" class="p-5 text-center">
        <div class="spinner-grow text-primary" style="width: 3rem; height: 3rem;" role="status">
          <span class="visually-hidden">Loading...</span>
        </div>
        <p class="mt-3 text-muted">Analyzing feedback data...</p>
      </div>

      <!-- Feedback Table -->
      <div *ngIf="!isLoading" class="table-responsive">
        <table class="table table-hover align-middle mb-0">
          <thead class="bg-light">
          <tr>
            <th scope="col" class="ps-4">User</th>
            <th scope="col">Rating</th>
            <th scope="col">Sentiment</th>
            <th scope="col" class="w-50">Feedback Message</th>
            <th scope="col">Date</th>
            <th scope="col" class="text-end pe-4">Actions</th>
          </tr>
          </thead>
          <tbody>
          <tr *ngFor="let feedback of feedbacks" class="border-top">
            <td class="ps-4">
              {{ feedback.user?.username || 'N/A' }}
            </td>
            <td>
              <div class="d-flex align-items-center">
                <div class="emoji-container me-2">
                  <span [ngSwitch]="feedback.feeling">
                    <span *ngSwitchCase="'EXCELLENT'" class="fs-4">😍</span>
                    <span *ngSwitchCase="'GOOD'" class="fs-4">😃</span>
                    <span *ngSwitchCase="'AVERAGE'" class="fs-4">😐</span>
                    <span *ngSwitchCase="'BAD'" class="fs-4">😕</span>
                    <span *ngSwitchCase="'TERRIBLE'" class="fs-4">😡</span>
                    <span *ngSwitchDefault class="fs-4">😐</span>
                  </span>
                </div>
                <span class="text-capitalize">{{ feedback.feeling?.toLowerCase() || 'N/A' }}</span>
              </div>
            </td>
            <td>
              <span class="badge rounded-pill py-2 px-3"
                    [ngClass]="getSentimentClass(feedback.sentiment)">
                {{ feedback.sentiment || 'NEUTRAL' }}
              </span>
            </td>
            <td>
              <div class="feedback-message-container">
                <p class="mb-0 text-break">{{ feedback.message || 'No message provided' }}</p>
              </div>
            </td>
            <td>{{ feedback.date | date:'shortDate' }}</td>
            <td class="text-end pe-4">
              <div class="btn-group btn-group-sm" role="group">
                <button class="btn btn-outline-primary rounded-start-pill px-3" (click)="editFeedback(feedback)">
                  <i class="bi bi-pencil"></i>
                </button>
                <button *ngIf="feedback.idFeedback" class="btn btn-outline-danger rounded-end-pill px-3"
                        (click)="deleteFeedback(feedback.idFeedback)">
                  <i class="bi bi-trash"></i>
                </button>
              </div>
            </td>
          </tr>
          </tbody>
        </table>
      </div>

      <!-- Empty State -->
      <div *ngIf="feedbacks.length === 0 && !isLoading" class="text-center p-5 bg-light">
        <div class="py-4">
          <i class="bi bi-chat-left-text text-muted" style="font-size: 3rem;"></i>
          <h5 class="mt-3 text-muted">No feedback yet</h5>
          <p class="text-muted">There are no feedback responses for this event.</p>
        </div>
      </div>
    </div>
  </div>
</div>
